<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>

















<main>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<h1>RESTAURANT REVENUE PREDICTION<a rel="noopener" class="anchor-link" href="#RESTAURANT-REVENUE-PREDICTION">&#182;</a></h1>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>jovian
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting jovian
  Downloading jovian-0.2.45-py2.py3-none-any.whl (68 kB)
     <span class="ansi-black-intense-fg">━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-green-fg">68.6/68.6 KB</span> <span class="ansi-red-fg">3.0 MB/s</span> eta <span class="ansi-cyan-fg">0:00:00</span>
Requirement already satisfied: click in /usr/local/lib/python3.8/dist-packages (from jovian) (7.1.2)
Requirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from jovian) (2.25.1)
Collecting uuid
  Downloading uuid-1.30.tar.gz (5.8 kB)
  Preparing metadata (setup.py) ... done
Requirement already satisfied: pyyaml in /usr/local/lib/python3.8/dist-packages (from jovian) (6.0)
Requirement already satisfied: urllib3&lt;1.27,&gt;=1.21.1 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;jovian) (1.24.3)
Requirement already satisfied: chardet&lt;5,&gt;=3.0.2 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;jovian) (4.0.0)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;jovian) (2.10)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;jovian) (2022.12.7)
Building wheels for collected packages: uuid
  Building wheel for uuid (setup.py) ... done
  Created wheel for uuid: filename=uuid-1.30-py3-none-any.whl size=6502 sha256=2b2cfc1153c3a59c7208daa1c962779945a956e9613d75f0587b7ecedf366790
  Stored in directory: /root/.cache/pip/wheels/1b/6c/cb/f9aae2bc97333c3d6e060826c1ee9e44e46306a178e5783505
Successfully built uuid
Installing collected packages: uuid, jovian
Successfully installed jovian-0.2.45 uuid-1.30
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">jovian</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>opendatasets<span class="w"> </span>pandas<span class="w"> </span>numpy<span class="w"> </span>scikit-learn<span class="w"> </span>xgboost
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting opendatasets
  Downloading opendatasets-0.1.22-py3-none-any.whl (15 kB)
Requirement already satisfied: pandas in /usr/local/lib/python3.8/dist-packages (1.3.5)
Requirement already satisfied: numpy in /usr/local/lib/python3.8/dist-packages (1.21.6)
Requirement already satisfied: scikit-learn in /usr/local/lib/python3.8/dist-packages (1.0.2)
Requirement already satisfied: xgboost in /usr/local/lib/python3.8/dist-packages (0.90)
Requirement already satisfied: kaggle in /usr/local/lib/python3.8/dist-packages (from opendatasets) (1.5.12)
Requirement already satisfied: tqdm in /usr/local/lib/python3.8/dist-packages (from opendatasets) (4.64.1)
Requirement already satisfied: click in /usr/local/lib/python3.8/dist-packages (from opendatasets) (7.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.8/dist-packages (from pandas) (2.8.2)
Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.8/dist-packages (from pandas) (2022.7)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.8/dist-packages (from scikit-learn) (3.1.0)
Requirement already satisfied: joblib&gt;=0.11 in /usr/local/lib/python3.8/dist-packages (from scikit-learn) (1.2.0)
Requirement already satisfied: scipy&gt;=1.1.0 in /usr/local/lib/python3.8/dist-packages (from scikit-learn) (1.7.3)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.8/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas) (1.15.0)
Requirement already satisfied: certifi in /usr/local/lib/python3.8/dist-packages (from kaggle-&gt;opendatasets) (2022.12.7)
Requirement already satisfied: python-slugify in /usr/local/lib/python3.8/dist-packages (from kaggle-&gt;opendatasets) (7.0.0)
Requirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from kaggle-&gt;opendatasets) (2.25.1)
Requirement already satisfied: urllib3 in /usr/local/lib/python3.8/dist-packages (from kaggle-&gt;opendatasets) (1.24.3)
Requirement already satisfied: text-unidecode&gt;=1.3 in /usr/local/lib/python3.8/dist-packages (from python-slugify-&gt;kaggle-&gt;opendatasets) (1.3)
Requirement already satisfied: chardet&lt;5,&gt;=3.0.2 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;kaggle-&gt;opendatasets) (4.0.0)
Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;kaggle-&gt;opendatasets) (2.10)
Installing collected packages: opendatasets
Successfully installed opendatasets-0.1.22
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">opendatasets</span> <span class="k">as</span> <span class="nn">od</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">dataset_url</span> <span class="o">=</span> <span class="s1">&#39;https://www.kaggle.com/competitions/restaurant-revenue-prediction/data&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">od</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">dataset_url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Please provide your Kaggle credentials to download this dataset. Learn more: http://bit.ly/kaggle-creds
Your Kaggle username: abdulmajid23
Your Kaggle Key: &#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;&#183;
Downloading restaurant-revenue-prediction.zip to ./restaurant-revenue-prediction
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>100%|██████████| 2.68M/2.68M [00:00&lt;00:00, 159MB/s]</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>
Extracting archive ./restaurant-revenue-prediction/restaurant-revenue-prediction.zip to ./restaurant-revenue-prediction
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;restaurant-revenue-prediction&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> <span class="o">!</span>ls<span class="w"> </span>-lh<span class="w"> </span><span class="o">{</span>data_dir<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>total 4.0M
-rw-r--r-- 1 root root 1.6M Feb  1 20:46 sampleSubmission.csv
-rw-r--r-- 1 root root 2.5M Feb  1 20:46 test.csv.zip
-rw-r--r-- 1 root root 4.6K Feb  1 20:46 train.csv.zip
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># importing required modules</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
  
<span class="c1"># specifying the zip file name</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;./restaurant-revenue-prediction/test.csv.zip&quot;</span>
  
<span class="c1"># opening the zip file in READ mode</span>
<span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">zip</span><span class="p">:</span>
    <span class="c1"># printing all the contents of the zip file</span>
    <span class="nb">zip</span><span class="o">.</span><span class="n">printdir</span><span class="p">()</span>
  
    <span class="c1"># extracting all the files</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Extracting all the files now...&#39;</span><span class="p">)</span>
    <span class="nb">zip</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>File Name                                             Modified             Size
test.csv                                       2015-03-23 12:22:58     12843982
Extracting all the files now...
Done!
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># importing required modules</span>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>
  
<span class="c1"># specifying the zip file name</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;./restaurant-revenue-prediction/train.csv.zip&quot;</span>
  
<span class="c1"># opening the zip file in READ mode</span>
<span class="k">with</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="nb">zip</span><span class="p">:</span>
    <span class="c1"># printing all the contents of the zip file</span>
    <span class="nb">zip</span><span class="o">.</span><span class="n">printdir</span><span class="p">()</span>
  
    <span class="c1"># extracting all the files</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Extracting all the files now...&#39;</span><span class="p">)</span>
    <span class="nb">zip</span><span class="o">.</span><span class="n">extractall</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>File Name                                             Modified             Size
train.csv                                      2015-03-19 19:16:06        18885
Extracting all the files now...
Done!
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>wc<span class="w"> </span>-l<span class="w"> </span><span class="o">{</span>data_dir<span class="o">}</span>/train.csv
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>138 restaurant-revenue-prediction/train.csv
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>wc<span class="w"> </span>-l<span class="w"> </span><span class="o">{</span>data_dir<span class="o">}</span>/test.csv
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>100001 restaurant-revenue-prediction/test.csv
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>wc<span class="w"> </span>-l<span class="w"> </span><span class="o">{</span>data_dir<span class="o">}</span>/sampleSubmission.csv
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>100001 restaurant-revenue-prediction/sampleSubmission.csv
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>head<span class="w"> </span><span class="o">{</span>data_dir<span class="o">}</span>/train.csv
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Id,Open Date,City,City Group,Type,P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16,P17,P18,P19,P20,P21,P22,P23,P24,P25,P26,P27,P28,P29,P30,P31,P32,P33,P34,P35,P36,P37,revenue
0,07/17/1999,İstanbul,Big Cities,IL,4,5.0,4.0,4.0,2,2,5,4,5,5,3,5,5.0,1,2,2,2,4,5,4,1,3,3,1,1,1.0,4.0,2.0,3.0,5,3,4,5,5,4,3,4,5653753.0
1,02/14/2008,Ankara,Big Cities,FC,4,5.0,4.0,4.0,1,2,5,5,5,5,1,5,5.0,0,0,0,0,0,3,2,1,3,2,0,0,0.0,0.0,3.0,3.0,0,0,0,0,0,0,0,0,6923131.0
2,03/09/2013,Diyarbakır,Other,IL,2,4.0,2.0,5.0,2,3,5,5,5,5,2,5,5.0,0,0,0,0,0,1,1,1,1,1,0,0,0.0,0.0,1.0,3.0,0,0,0,0,0,0,0,0,2055379.0
3,02/02/2012,Tokat,Other,IL,6,4.5,6.0,6.0,4,4,10,8,10,10,8,10,7.5,6,4,9,3,12,20,12,6,1,10,2,2,2.5,2.5,2.5,7.5,25,12,10,6,18,12,12,6,2675511.0
4,05/09/2009,Gaziantep,Other,IL,3,4.0,3.0,4.0,2,2,5,5,5,5,2,5,5.0,2,1,2,1,4,2,2,1,2,1,2,3,3.0,5.0,1.0,3.0,5,1,3,2,3,4,3,3,4316715.0
5,02/12/2010,Ankara,Big Cities,FC,6,6.0,4.5,7.5,8,10,10,8,8,8,10,8,6.0,0,0,0,0,0,5,6,3,1,5,0,0,0.0,0.0,7.5,5.0,0,0,0,0,0,0,0,0,5017319.0
6,10/11/2010,İstanbul,Big Cities,IL,2,3.0,4.0,4.0,1,5,5,5,5,5,2,5,5.0,3,4,4,3,4,2,4,1,2,1,5,4,4.0,5.0,1.0,3.0,4,5,2,2,3,5,4,4,5166635.0
7,06/21/2011,İstanbul,Big Cities,IL,4,5.0,4.0,5.0,2,3,5,4,4,4,4,3,4.0,0,0,0,0,0,3,5,2,4,2,0,0,0.0,0.0,3.0,2.0,0,0,0,0,0,0,0,0,4491607.0
8,08/28/2010,Afyonkarahisar,Other,IL,1,1.0,4.0,4.0,1,2,1,5,5,5,1,5,5.0,1,1,2,1,4,1,1,1,1,1,4,4,4.0,2.0,2.0,3.0,4,5,5,3,4,5,4,5,4952497.0
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>head<span class="w"> </span><span class="o">{</span>data_dir<span class="o">}</span>/test.csv
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Id,Open Date,City,City Group,Type,P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16,P17,P18,P19,P20,P21,P22,P23,P24,P25,P26,P27,P28,P29,P30,P31,P32,P33,P34,P35,P36,P37
0,01/22/2011,Niğde,Other,FC,1,4.0,4.0,4.0,1,2,5,4,5,5,5,3,4.0,0,0,0,2,0,5,5,3,1,4,0,0,0.0,0.0,2.0,3.0,0,0,0,0,0,0,0,0
1,03/18/2011,Konya,Other,IL,3,4.0,4.0,4.0,2,2,5,3,4,4,2,4,5.0,0,0,0,0,0,5,5,3,2,1,0,0,0.0,0.0,1.0,3.0,0,0,0,0,0,0,0,0
2,10/30/2013,Ankara,Big Cities,FC,3,4.0,4.0,4.0,2,2,5,4,4,5,4,5,5.0,0,0,0,0,0,5,5,5,5,5,0,0,0.0,0.0,2.0,3.0,0,0,0,0,0,0,0,0
3,05/06/2013,Kocaeli,Other,IL,2,4.0,4.0,4.0,2,3,5,4,5,4,3,4,5.0,0,0,0,0,4,4,4,3,2,2,0,0,0.0,0.0,2.0,3.0,0,4,0,0,0,0,0,0
4,07/31/2013,Afyonkarahisar,Other,FC,2,4.0,4.0,4.0,1,2,5,4,5,4,3,5,4.0,0,0,0,0,0,1,5,3,1,1,0,0,0.0,0.0,5.0,3.0,0,0,0,0,0,0,0,0
5,11/29/2007,Eskişehir,Other,FC,4,4.5,5.0,4.0,2,6,5,5,10,10,2,5,7.5,0,0,0,0,0,2,5,3,2,3,0,0,0.0,0.0,2.0,3.0,0,0,0,0,0,0,0,0
6,11/05/2008,Rize,Other,FC,4,2.0,4.0,4.0,2,2,5,4,5,5,3,5,5.0,1,0,0,1,0,5,5,2,2,3,2,5,0.0,0.0,1.0,3.0,3,5,4,1,2,0,0,0
7,12/03/2013,Ankara,Big Cities,IL,2,5.0,4.0,5.0,2,3,5,4,4,4,2,4,5.0,0,0,5,2,0,5,4,2,1,3,2,0,0.0,1.0,3.0,1.0,3,0,0,0,3,0,4,4
8,05/30/2006,İstanbul,Big Cities,IL,5,4.0,4.0,4.0,1,3,5,4,4,4,2,4,5.0,0,4,0,3,4,3,5,1,5,2,0,4,0.0,1.0,5.0,1.0,0,4,0,0,3,5,0,0
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">!</span>head<span class="w"> </span><span class="o">{</span>data_dir<span class="o">}</span>/sampleSubmission.csv<span class="w"> </span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>Id,Prediction
0,4453532.6
1,4453532.6
2,4453532.6
3,4453532.6
4,4453532.6
5,4453532.6
6,4453532.6
7,4453532.6
8,4453532.6
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span><span class="o">+</span><span class="s2">&quot;/train.csv&quot;</span><span class="p">)</span>
                
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Open Date</th>
<th>City</th>
<th>City Group</th>
<th>Type</th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>...</th>
<th>P29</th>
<th>P30</th>
<th>P31</th>
<th>P32</th>
<th>P33</th>
<th>P34</th>
<th>P35</th>
<th>P36</th>
<th>P37</th>
<th>revenue</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>07/17/1999</td>
<td>İstanbul</td>
<td>Big Cities</td>
<td>IL</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>3.0</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>3</td>
<td>4</td>
<td>5653753.0</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>02/14/2008</td>
<td>Ankara</td>
<td>Big Cities</td>
<td>FC</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>...</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6923131.0</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>03/09/2013</td>
<td>Diyarbakır</td>
<td>Other</td>
<td>IL</td>
<td>2</td>
<td>4.0</td>
<td>2.0</td>
<td>5.0</td>
<td>2</td>
<td>...</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2055379.0</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>02/02/2012</td>
<td>Tokat</td>
<td>Other</td>
<td>IL</td>
<td>6</td>
<td>4.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>7.5</td>
<td>25</td>
<td>12</td>
<td>10</td>
<td>6</td>
<td>18</td>
<td>12</td>
<td>12</td>
<td>6</td>
<td>2675511.0</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>05/09/2009</td>
<td>Gaziantep</td>
<td>Other</td>
<td>IL</td>
<td>3</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>3.0</td>
<td>5</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>4316715.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>132</th>
<td>132</td>
<td>06/25/2008</td>
<td>Trabzon</td>
<td>Other</td>
<td>FC</td>
<td>2</td>
<td>3.0</td>
<td>3.0</td>
<td>5.0</td>
<td>4</td>
<td>...</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>5787594.0</td>
</tr>
<tr>
<th>133</th>
<td>133</td>
<td>10/12/2006</td>
<td>İzmir</td>
<td>Big Cities</td>
<td>FC</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>9262754.0</td>
</tr>
<tr>
<th>134</th>
<td>134</td>
<td>07/08/2006</td>
<td>Kayseri</td>
<td>Other</td>
<td>FC</td>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>2544857.0</td>
</tr>
<tr>
<th>135</th>
<td>135</td>
<td>10/29/2010</td>
<td>İstanbul</td>
<td>Big Cities</td>
<td>FC</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>2</td>
<td>...</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>7217634.0</td>
</tr>
<tr>
<th>136</th>
<td>136</td>
<td>09/01/2009</td>
<td>İstanbul</td>
<td>Big Cities</td>
<td>FC</td>
<td>4</td>
<td>5.0</td>
<td>3.0</td>
<td>5.0</td>
<td>2</td>
<td>...</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>6363241.0</td>
</tr>
</tbody>
</table>
<p>137 rows &#215; 43 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;City Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([&#39;Big Cities&#39;, &#39;Other&#39;], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;City Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Big Cities&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>0      0
1      0
2      1
3      1
4      1
      ..
132    1
133    0
134    1
135    0
136    0
Name: City Group, Length: 137, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([&#39;IL&#39;, &#39;FC&#39;, &#39;DT&#39;], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;IL&#39;</span><span class="p">,</span> <span class="s1">&#39;FC&#39;</span><span class="p">,</span> <span class="s1">&#39;DT&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Open Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Open Date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;City Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;City Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Big Cities&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 137 entries, 0 to 136
Data columns (total 43 columns):
 #   Column      Non-Null Count  Dtype         
---  ------      --------------  -----         
 0   Id          137 non-null    int64         
 1   Open Date   137 non-null    datetime64[ns]
 2   City        137 non-null    object        
 3   City Group  137 non-null    int64         
 4   Type        137 non-null    int64         
 5   P1          137 non-null    int64         
 6   P2          137 non-null    float64       
 7   P3          137 non-null    float64       
 8   P4          137 non-null    float64       
 9   P5          137 non-null    int64         
 10  P6          137 non-null    int64         
 11  P7          137 non-null    int64         
 12  P8          137 non-null    int64         
 13  P9          137 non-null    int64         
 14  P10         137 non-null    int64         
 15  P11         137 non-null    int64         
 16  P12         137 non-null    int64         
 17  P13         137 non-null    float64       
 18  P14         137 non-null    int64         
 19  P15         137 non-null    int64         
 20  P16         137 non-null    int64         
 21  P17         137 non-null    int64         
 22  P18         137 non-null    int64         
 23  P19         137 non-null    int64         
 24  P20         137 non-null    int64         
 25  P21         137 non-null    int64         
 26  P22         137 non-null    int64         
 27  P23         137 non-null    int64         
 28  P24         137 non-null    int64         
 29  P25         137 non-null    int64         
 30  P26         137 non-null    float64       
 31  P27         137 non-null    float64       
 32  P28         137 non-null    float64       
 33  P29         137 non-null    float64       
 34  P30         137 non-null    int64         
 35  P31         137 non-null    int64         
 36  P32         137 non-null    int64         
 37  P33         137 non-null    int64         
 38  P34         137 non-null    int64         
 39  P35         137 non-null    int64         
 40  P36         137 non-null    int64         
 41  P37         137 non-null    int64         
 42  revenue     137 non-null    float64       
dtypes: datetime64[ns](1), float64(9), int64(32), object(1)
memory usage: 46.1+ KB
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jovian</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>City Group</th>
<th>Type</th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>P6</th>
<th>P7</th>
<th>...</th>
<th>P29</th>
<th>P30</th>
<th>P31</th>
<th>P32</th>
<th>P33</th>
<th>P34</th>
<th>P35</th>
<th>P36</th>
<th>P37</th>
<th>revenue</th>
</tr>
</thead>
<tbody>
<tr>
<th>count</th>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>...</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>137.000000</td>
<td>1.370000e+02</td>
</tr>
<tr>
<th>mean</th>
<td>68.000000</td>
<td>0.430657</td>
<td>1.569343</td>
<td>4.014599</td>
<td>4.408759</td>
<td>4.317518</td>
<td>4.372263</td>
<td>2.007299</td>
<td>3.357664</td>
<td>5.423358</td>
<td>...</td>
<td>3.135036</td>
<td>2.729927</td>
<td>1.941606</td>
<td>2.525547</td>
<td>1.138686</td>
<td>2.489051</td>
<td>2.029197</td>
<td>2.211679</td>
<td>1.116788</td>
<td>4.453533e+06</td>
</tr>
<tr>
<th>std</th>
<td>39.692569</td>
<td>0.496985</td>
<td>0.511567</td>
<td>2.910391</td>
<td>1.514900</td>
<td>1.032337</td>
<td>1.016462</td>
<td>1.209620</td>
<td>2.134235</td>
<td>2.296809</td>
<td>...</td>
<td>1.680887</td>
<td>5.536647</td>
<td>3.512093</td>
<td>5.230117</td>
<td>1.698540</td>
<td>5.165093</td>
<td>3.436272</td>
<td>4.168211</td>
<td>1.790768</td>
<td>2.576072e+06</td>
</tr>
<tr>
<th>min</th>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>3.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>...</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.149870e+06</td>
</tr>
<tr>
<th>25%</th>
<td>34.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>4.000000</td>
<td>4.000000</td>
<td>4.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>5.000000</td>
<td>...</td>
<td>2.500000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>2.999068e+06</td>
</tr>
<tr>
<th>50%</th>
<td>68.000000</td>
<td>0.000000</td>
<td>2.000000</td>
<td>3.000000</td>
<td>5.000000</td>
<td>4.000000</td>
<td>4.000000</td>
<td>2.000000</td>
<td>3.000000</td>
<td>5.000000</td>
<td>...</td>
<td>3.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>3.939804e+06</td>
</tr>
<tr>
<th>75%</th>
<td>102.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>4.000000</td>
<td>5.000000</td>
<td>5.000000</td>
<td>5.000000</td>
<td>2.000000</td>
<td>4.000000</td>
<td>5.000000</td>
<td>...</td>
<td>3.000000</td>
<td>4.000000</td>
<td>3.000000</td>
<td>3.000000</td>
<td>2.000000</td>
<td>3.000000</td>
<td>4.000000</td>
<td>3.000000</td>
<td>2.000000</td>
<td>5.166635e+06</td>
</tr>
<tr>
<th>max</th>
<td>136.000000</td>
<td>1.000000</td>
<td>3.000000</td>
<td>12.000000</td>
<td>7.500000</td>
<td>7.500000</td>
<td>7.500000</td>
<td>8.000000</td>
<td>10.000000</td>
<td>10.000000</td>
<td>...</td>
<td>7.500000</td>
<td>25.000000</td>
<td>15.000000</td>
<td>25.000000</td>
<td>6.000000</td>
<td>24.000000</td>
<td>15.000000</td>
<td>20.000000</td>
<td>8.000000</td>
<td>1.969694e+07</td>
</tr>
</tbody>
</table>
<p>8 rows &#215; 41 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jovian</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span><span class="o">+</span><span class="s1">&#39;/test.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;City Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([&#39;Other&#39;, &#39;Big Cities&#39;], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([&#39;FC&#39;, &#39;IL&#39;, &#39;DT&#39;, &#39;MB&#39;], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;Open Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;Open Date&#39;</span><span class="p">])</span>
<span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;City Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="s1">&#39;City Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span><span class="s1">&#39;Big Cities&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">test_df</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">Type</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;IL&#39;</span><span class="p">,</span> <span class="s1">&#39;FC&#39;</span><span class="p">,</span> <span class="s1">&#39;DT&#39;</span><span class="p">,</span> <span class="s1">&#39;MB&#39;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 100000 entries, 0 to 99999
Data columns (total 53 columns):
 #   Column                   Non-Null Count   Dtype         
---  ------                   --------------   -----         
 0   Id                       100000 non-null  int64         
 1   Open Date                100000 non-null  datetime64[ns]
 2   City                     100000 non-null  object        
 3   City Group               100000 non-null  int64         
 4   Type                     100000 non-null  int64         
 5   P1                       100000 non-null  int64         
 6   P2                       100000 non-null  float64       
 7   P3                       100000 non-null  float64       
 8   P4                       100000 non-null  float64       
 9   P5                       100000 non-null  int64         
 10  P6                       100000 non-null  int64         
 11  P7                       100000 non-null  int64         
 12  P8                       100000 non-null  int64         
 13  P9                       100000 non-null  int64         
 14  P10                      100000 non-null  int64         
 15  P11                      100000 non-null  int64         
 16  P12                      100000 non-null  int64         
 17  P13                      100000 non-null  float64       
 18  P14                      100000 non-null  int64         
 19  P15                      100000 non-null  int64         
 20  P16                      100000 non-null  int64         
 21  P17                      100000 non-null  int64         
 22  P18                      100000 non-null  int64         
 23  P19                      100000 non-null  int64         
 24  P20                      100000 non-null  int64         
 25  P21                      100000 non-null  int64         
 26  P22                      100000 non-null  int64         
 27  P23                      100000 non-null  int64         
 28  P24                      100000 non-null  int64         
 29  P25                      100000 non-null  int64         
 30  P26                      100000 non-null  float64       
 31  P27                      100000 non-null  float64       
 32  P28                      100000 non-null  float64       
 33  P29                      100000 non-null  float64       
 34  P30                      100000 non-null  int64         
 35  P31                      100000 non-null  int64         
 36  P32                      100000 non-null  int64         
 37  P33                      100000 non-null  int64         
 38  P34                      100000 non-null  int64         
 39  P35                      100000 non-null  int64         
 40  P36                      100000 non-null  int64         
 41  P37                      100000 non-null  int64         
 42  Open Date_year           100000 non-null  int64         
 43  Open Date_month          100000 non-null  int64         
 44  Open Date_day            100000 non-null  int64         
 45  Open Date_weekday        100000 non-null  int64         
 46  Open Date_quarter        100000 non-null  int64         
 47  Open Date_month_start    100000 non-null  int64         
 48  Open Date_month_end      100000 non-null  int64         
 49  Open Date_quarter_start  100000 non-null  int64         
 50  Open Date_quarter_end    100000 non-null  int64         
 51  Open Date_year_start     100000 non-null  int64         
 52  Open Date_year_end       100000 non-null  int64         
dtypes: datetime64[ns](1), float64(8), int64(43), object(1)
memory usage: 40.4+ MB
</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>City Group</th>
<th>Type</th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>P6</th>
<th>P7</th>
<th>...</th>
<th>Open Date_month</th>
<th>Open Date_day</th>
<th>Open Date_weekday</th>
<th>Open Date_quarter</th>
<th>Open Date_month_start</th>
<th>Open Date_month_end</th>
<th>Open Date_quarter_start</th>
<th>Open Date_quarter_end</th>
<th>Open Date_year_start</th>
<th>Open Date_year_end</th>
</tr>
</thead>
<tbody>
<tr>
<th>count</th>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.00000</td>
<td>...</td>
<td>100000.000000</td>
<td>100000.00000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.00000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
<td>100000.000000</td>
</tr>
<tr>
<th>mean</th>
<td>49999.500000</td>
<td>0.507280</td>
<td>1.623770</td>
<td>4.088030</td>
<td>4.428085</td>
<td>4.215325</td>
<td>4.396025</td>
<td>1.989590</td>
<td>2.881900</td>
<td>5.30051</td>
<td>...</td>
<td>6.954610</td>
<td>14.52091</td>
<td>3.101490</td>
<td>2.629070</td>
<td>0.07147</td>
<td>0.021970</td>
<td>0.005920</td>
<td>0.012440</td>
<td>0.002860</td>
<td>0.006090</td>
</tr>
<tr>
<th>std</th>
<td>28867.657797</td>
<td>0.499949</td>
<td>0.544944</td>
<td>2.812963</td>
<td>1.428865</td>
<td>0.842161</td>
<td>1.035827</td>
<td>1.065314</td>
<td>1.531429</td>
<td>2.17858</td>
<td>...</td>
<td>3.376733</td>
<td>9.00582</td>
<td>1.770927</td>
<td>1.106098</td>
<td>0.25761</td>
<td>0.146586</td>
<td>0.076714</td>
<td>0.110839</td>
<td>0.053403</td>
<td>0.077801</td>
</tr>
<tr>
<th>min</th>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>0.000000</td>
<td>2.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.00000</td>
<td>...</td>
<td>1.000000</td>
<td>1.00000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>25%</th>
<td>24999.750000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>3.750000</td>
<td>4.000000</td>
<td>4.000000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>5.00000</td>
<td>...</td>
<td>4.000000</td>
<td>6.00000</td>
<td>2.000000</td>
<td>2.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>50%</th>
<td>49999.500000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>3.000000</td>
<td>5.000000</td>
<td>4.000000</td>
<td>4.000000</td>
<td>2.000000</td>
<td>2.000000</td>
<td>5.00000</td>
<td>...</td>
<td>7.000000</td>
<td>15.00000</td>
<td>4.000000</td>
<td>3.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>75%</th>
<td>74999.250000</td>
<td>1.000000</td>
<td>2.000000</td>
<td>4.000000</td>
<td>5.000000</td>
<td>4.000000</td>
<td>5.000000</td>
<td>2.000000</td>
<td>4.000000</td>
<td>5.00000</td>
<td>...</td>
<td>10.000000</td>
<td>22.00000</td>
<td>4.000000</td>
<td>4.000000</td>
<td>0.00000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr>
<th>max</th>
<td>99999.000000</td>
<td>1.000000</td>
<td>4.000000</td>
<td>15.000000</td>
<td>7.500000</td>
<td>6.000000</td>
<td>7.500000</td>
<td>6.000000</td>
<td>10.000000</td>
<td>10.00000</td>
<td>...</td>
<td>12.000000</td>
<td>31.00000</td>
<td>6.000000</td>
<td>4.000000</td>
<td>1.00000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
</tbody>
</table>
<p>8 rows &#215; 51 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="s1">&#39;Open Date&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[(</span><span class="s1">&#39;Open Date&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;datetime64[ns]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span><span class="p">[(</span><span class="s1">&#39;Open Date&#39;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[(</span><span class="s1">&#39;Open Date&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;datetime64[ns]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Split Training &amp; Validation Set</p>
<ul>
<li><p>We&#39;ll set aside 20% of the training data as the validation set, to evaluate the models we train on previously unseen data.</p>
</li>
<li><p>Since the test set and training set have the same date ranges, we can pick a random 20% fraction</p>
</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="p">,</span> <span class="n">val_df</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">train_df</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(109, 28)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Fill/Remove Missing Values</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">val_df</span> <span class="o">=</span> <span class="n">val_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Extract Inputs and Outputs</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>Index([&#39;Id&#39;, &#39;Open Date&#39;, &#39;City&#39;, &#39;City Group&#39;, &#39;Type&#39;, &#39;P1&#39;, &#39;P2&#39;, &#39;P3&#39;, &#39;P4&#39;,
       &#39;P5&#39;, &#39;P6&#39;, &#39;P7&#39;, &#39;P8&#39;, &#39;P9&#39;, &#39;P10&#39;, &#39;P11&#39;, &#39;P12&#39;, &#39;P13&#39;, &#39;P14&#39;, &#39;P15&#39;,
       &#39;P16&#39;, &#39;P17&#39;, &#39;P18&#39;, &#39;P19&#39;, &#39;P20&#39;, &#39;P21&#39;, &#39;P22&#39;, &#39;P23&#39;, &#39;P24&#39;, &#39;P25&#39;,
       &#39;P26&#39;, &#39;P27&#39;, &#39;P28&#39;, &#39;P29&#39;, &#39;P30&#39;, &#39;P31&#39;, &#39;P32&#39;, &#39;P33&#39;, &#39;P34&#39;, &#39;P35&#39;,
       &#39;P36&#39;, &#39;P37&#39;, &#39;revenue&#39;],
      dtype=&#39;object&#39;)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">input_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;P2&#39;</span><span class="p">,</span> <span class="s1">&#39;P3&#39;</span><span class="p">,</span> <span class="s1">&#39;P4&#39;</span><span class="p">,</span>
       <span class="s1">&#39;P5&#39;</span><span class="p">,</span> <span class="s1">&#39;P6&#39;</span><span class="p">,</span> <span class="s1">&#39;P7&#39;</span><span class="p">,</span> <span class="s1">&#39;P8&#39;</span><span class="p">,</span> <span class="s1">&#39;P9&#39;</span><span class="p">,</span> <span class="s1">&#39;P10&#39;</span><span class="p">,</span> <span class="s1">&#39;P11&#39;</span><span class="p">,</span> <span class="s1">&#39;P12&#39;</span><span class="p">,</span> <span class="s1">&#39;P13&#39;</span><span class="p">,</span> <span class="s1">&#39;P14&#39;</span><span class="p">,</span> <span class="s1">&#39;P15&#39;</span><span class="p">,</span>
       <span class="s1">&#39;P16&#39;</span><span class="p">,</span> <span class="s1">&#39;P17&#39;</span><span class="p">,</span> <span class="s1">&#39;P18&#39;</span><span class="p">,</span> <span class="s1">&#39;P19&#39;</span><span class="p">,</span> <span class="s1">&#39;P20&#39;</span><span class="p">,</span> <span class="s1">&#39;P21&#39;</span><span class="p">,</span> <span class="s1">&#39;P22&#39;</span><span class="p">,</span> <span class="s1">&#39;P23&#39;</span><span class="p">,</span> <span class="s1">&#39;P24&#39;</span><span class="p">,</span> <span class="s1">&#39;P25&#39;</span><span class="p">,</span>
       <span class="s1">&#39;P26&#39;</span><span class="p">,</span> <span class="s1">&#39;P27&#39;</span><span class="p">,</span> <span class="s1">&#39;P28&#39;</span><span class="p">,</span> <span class="s1">&#39;P29&#39;</span><span class="p">,</span> <span class="s1">&#39;P30&#39;</span><span class="p">,</span> <span class="s1">&#39;P31&#39;</span><span class="p">,</span> <span class="s1">&#39;P32&#39;</span><span class="p">,</span> <span class="s1">&#39;P33&#39;</span><span class="p">,</span> <span class="s1">&#39;P34&#39;</span><span class="p">,</span> <span class="s1">&#39;P35&#39;</span><span class="p">,</span>
       <span class="s1">&#39;P36&#39;</span><span class="p">,</span> <span class="s1">&#39;P37&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">target_col</span> <span class="o">=</span> <span class="s1">&#39;revenue&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Training</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_inputs</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">input_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_targets</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_inputs</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>P6</th>
<th>P7</th>
<th>P8</th>
<th>P9</th>
<th>P10</th>
<th>...</th>
<th>P28</th>
<th>P29</th>
<th>P30</th>
<th>P31</th>
<th>P32</th>
<th>P33</th>
<th>P34</th>
<th>P35</th>
<th>P36</th>
<th>P37</th>
</tr>
</thead>
<tbody>
<tr>
<th>10</th>
<td>9</td>
<td>6.0</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>4</td>
<td>10</td>
<td>8</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>10.0</td>
<td>2.5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>130</th>
<td>3</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>2</td>
<td>1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>51</th>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>4</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>11</th>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>3.0</td>
<td>3.0</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<th>114</th>
<td>4</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>4.0</td>
<td>1.0</td>
<td>5</td>
<td>3</td>
<td>3</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>71</th>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>2</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>10.0</td>
<td>7.5</td>
<td>5</td>
<td>6</td>
<td>10</td>
<td>6</td>
<td>18</td>
<td>12</td>
<td>12</td>
<td>6</td>
</tr>
<tr>
<th>106</th>
<td>3</td>
<td>3.0</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>2</td>
<td>2</td>
<td>8</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>2.5</td>
<td>7.5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>14</th>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>92</th>
<td>12</td>
<td>7.5</td>
<td>7.5</td>
<td>6.0</td>
<td>2</td>
<td>10</td>
<td>10</td>
<td>8</td>
<td>8</td>
<td>10</td>
<td>...</td>
<td>10.0</td>
<td>7.5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>102</th>
<td>4</td>
<td>5.0</td>
<td>2.0</td>
<td>5.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>109 rows &#215; 37 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_targets</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>10     3745135.0
130    3376145.0
51     3273041.0
11     5161370.0
114    4155435.0
         ...    
71     4136425.0
106    4888774.0
14     1999097.0
92     6782425.0
102    2738052.0
Name: revenue, Length: 109, dtype: float64</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_inputs</span> <span class="o">=</span> <span class="n">val_df</span><span class="p">[</span><span class="n">input_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_targets</span> <span class="o">=</span> <span class="n">val_df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_inputs</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>P6</th>
<th>P7</th>
<th>P8</th>
<th>P9</th>
<th>P10</th>
<th>...</th>
<th>P28</th>
<th>P29</th>
<th>P30</th>
<th>P31</th>
<th>P32</th>
<th>P33</th>
<th>P34</th>
<th>P35</th>
<th>P36</th>
<th>P37</th>
</tr>
</thead>
<tbody>
<tr>
<th>105</th>
<td>1</td>
<td>2.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>1.0</td>
<td>2.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>104</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>3</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>5</td>
<td>5</td>
<td>3</td>
<td>3</td>
<td>5</td>
<td>4</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<th>12</th>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>1</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>26</th>
<td>3</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>2</td>
<td>3</td>
<td>5</td>
<td>3</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>3.0</td>
<td>3.0</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<th>123</th>
<td>1</td>
<td>1.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>66</th>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>64</th>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>2</td>
<td>8</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>5.0</td>
<td>7.5</td>
<td>20</td>
<td>15</td>
<td>25</td>
<td>4</td>
<td>24</td>
<td>15</td>
<td>20</td>
<td>6</td>
</tr>
<tr>
<th>115</th>
<td>6</td>
<td>4.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>8</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>5.0</td>
<td>7.5</td>
<td>25</td>
<td>15</td>
<td>25</td>
<td>4</td>
<td>18</td>
<td>12</td>
<td>16</td>
<td>8</td>
</tr>
<tr>
<th>133</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>3</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>5</td>
<td>...</td>
<td>3.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>85</th>
<td>3</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>84</th>
<td>4</td>
<td>4.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1</td>
<td>3</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>2</td>
<td>4</td>
<td>4</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<th>45</th>
<td>6</td>
<td>6.0</td>
<td>6.0</td>
<td>4.5</td>
<td>2</td>
<td>8</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>8</td>
<td>...</td>
<td>5.0</td>
<td>7.5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>69</th>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>5.0</td>
<td>4</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>67</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>2</td>
<td>4</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>5.0</td>
<td>1.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>31</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>3</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<th>42</th>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>4</td>
<td>10</td>
<td>8</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>7.5</td>
<td>5.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>27</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>5</td>
<td>...</td>
<td>4.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>19</th>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>132</th>
<td>2</td>
<td>3.0</td>
<td>3.0</td>
<td>5.0</td>
<td>4</td>
<td>2</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>56</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>3.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>125</th>
<td>9</td>
<td>6.0</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>6</td>
<td>10</td>
<td>6</td>
<td>8</td>
<td>10</td>
<td>...</td>
<td>5.0</td>
<td>7.5</td>
<td>20</td>
<td>9</td>
<td>15</td>
<td>4</td>
<td>24</td>
<td>12</td>
<td>16</td>
<td>2</td>
</tr>
<tr>
<th>4</th>
<td>3</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>5</td>
<td>1</td>
<td>3</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<th>109</th>
<td>2</td>
<td>4.0</td>
<td>3.0</td>
<td>5.0</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>3.0</td>
<td>2.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>36</th>
<td>3</td>
<td>5.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>3.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>89</th>
<td>1</td>
<td>1.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>3</td>
<td>3</td>
<td>4</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<th>100</th>
<td>3</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>4.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>16</th>
<td>3</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>2.0</td>
<td>2.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>18</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>3</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>3</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>28 rows &#215; 37 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_targets</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>105     2792031.0
104     4467728.0
12      1734634.0
26      2267425.0
123     4263629.0
66      1882131.0
64      2551252.0
115     4882985.0
133     9262754.0
85      7495092.0
84      4250553.0
45      3752885.0
69      3452382.0
67      4052733.0
31      2058644.0
42      4952255.0
27      5435276.0
19      2021934.0
132     5787594.0
56      2390534.0
125     4780607.0
4       4316715.0
109     4219263.0
36      3028267.0
89      2364478.0
100     9652350.0
16     19696939.0
18      5337526.0
Name: revenue, dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Test</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_inputs</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="n">input_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_inputs</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>P6</th>
<th>P7</th>
<th>P8</th>
<th>P9</th>
<th>P10</th>
<th>...</th>
<th>P28</th>
<th>P29</th>
<th>P30</th>
<th>P31</th>
<th>P32</th>
<th>P33</th>
<th>P34</th>
<th>P35</th>
<th>P36</th>
<th>P37</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>3</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>5.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>5</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99996</th>
<td>1</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99997</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>...</td>
<td>4.0</td>
<td>1.0</td>
<td>5</td>
<td>5</td>
<td>3</td>
<td>2</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<th>99998</th>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>4</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>7.5</td>
<td>5.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99999</th>
<td>2</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>5.0</td>
<td>3.0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>4</td>
<td>2</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 37 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jovian</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Train Hardcoded &amp; Baseline Models</p>
<ul>
<li>Hardcoded model: always predict average revenue</li>
<li>Baseline model: Linear regression</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Train &amp; Evaluate Hardcoded Model</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">MeanRegressor</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">inputs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">mean_model</span> <span class="o">=</span> <span class="n">MeanRegressor</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">mean_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">mean_model</span><span class="o">.</span><span class="n">mean</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>4375994.23853211</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_preds</span> <span class="o">=</span> <span class="n">mean_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_preds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([ 5484206.69821504,  4719200.54316565,  2205105.97527134,
        5147026.47753844,  4259298.95939845,  3198056.13579884,
        4512692.10702536,  4559040.79067531,  4669320.12831727,
        6011644.50359368,  3097790.32255599,  4695066.428377  ,
        6831468.39309326,  7918699.59102941,  3049832.53402904,
        4847162.75164324,  1784850.61090642,  5245702.57609862,
        2922967.95372078,  2887927.33590722,  3458525.1712513 ,
        2575384.24470186,  5650306.82122365,  5752826.15189686,
        6165943.94621238,  9194727.12132213,  2053312.5741837 ,
        5769282.92226064,  3470096.87841949,  4602950.12368706,
        3703393.60514414,  5012971.22654393,  5367049.9286823 ,
        7373618.14888251,  6244883.33920079,  3462594.8862648 ,
        2733570.19994912,  3555446.84417066,  4939710.03065109,
        3760242.8345347 ,  2664302.41212013, 10011383.75529808,
        3157269.69833913,  4897305.92765775,  3863964.92687061,
        4142628.50479776,  3423405.34835866,  4345839.99080846,
        4963894.65328336,  3441816.12257376,  3475065.83901095,
        6440446.81275028,  4393270.46029204,  4673033.36430237,
        2757749.80655551,  4619369.93168536,  3474200.31882915,
        2845815.89963582,  2777205.34535855,  3931587.09808683,
        6258972.84647816,  4468591.05888534,  3733758.94763789,
        5655133.99788916,  2836437.22409075,  1950133.78519136,
        3767200.939899  ,  5421510.59940666,  5909198.00133342,
        3315250.02932402,  3486818.38385388,  3443601.17135182,
        3164774.52765518,  6013806.34028003,  2461268.86857468,
        3146301.14235437,  4159837.84991595,  2798510.34338599,
        3457223.71117654,  5173122.3324576 ,  9396245.93237117,
        4195073.87016436,  4018989.58480063,  3761502.65517938,
        1353482.73682433,  1484104.28741917,  3958535.39109778,
        3695851.01739058,  3652336.50949028,  2928228.28362989,
        5407872.81474823,  2133571.28077376,  3416407.71198156,
        3301608.34286538,  4240558.70379385,  1696052.03505069,
       10204044.96407387,  5050650.76513621,  5587774.26962495,
        5000808.01153025,  6034462.02061862,  4976196.12558651,
        5085804.94763255,  6532090.65272748,  4883520.30019024,
        3425545.59048003,  4075922.59218439,  5891622.19449541,
        3779602.27483612])</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_targets</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>10     3745135.0
130    3376145.0
51     3273041.0
11     5161370.0
114    4155435.0
         ...    
71     4136425.0
106    4888774.0
14     1999097.0
92     6782425.0
102    2738052.0
Name: revenue, Length: 109, dtype: float64</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_preds</span> <span class="o">=</span> <span class="n">mean_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_inputs</span><span class="p">)</span>
<span class="n">val_preds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211, 4375994.23853211, 4375994.23853211,
       4375994.23853211])</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_targets</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>105     2792031.0
104     4467728.0
12      1734634.0
26      2267425.0
123     4263629.0
66      1882131.0
64      2551252.0
115     4882985.0
133     9262754.0
85      7495092.0
84      4250553.0
45      3752885.0
69      3452382.0
67      4052733.0
31      2058644.0
42      4952255.0
27      5435276.0
19      2021934.0
132     5787594.0
56      2390534.0
125     4780607.0
4       4316715.0
109     4219263.0
36      3028267.0
89      2364478.0
100     9652350.0
16     19696939.0
18      5337526.0
Name: revenue, dtype: float64</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">rsme</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">preds</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">train_targets</span><span class="p">,</span> <span class="n">train_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">train_rmse</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>1525302.3169612505</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">val_targets</span><span class="p">,</span> <span class="n">val_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">val_rmse</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>3518219.755194293</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Train &amp; Evaluate Baseline Model</p>
<ul>
<li>We&#39;ll train a linear regression model as our baseline, which tries to express the target as a weighted sum of the inputs.</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">linreg_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">linreg_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearRegression()</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_preds</span> <span class="o">=</span> <span class="n">linreg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">)</span>
<span class="n">train_preds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([ 5909500.07662184,  4216242.33966954,  2459387.71451401,
        4589022.8451477 ,  3654773.94094013,  2461600.49675438,
        4412304.38965005,  4636085.46974963,  4731959.51120412,
        5462766.43552126,  3386048.62101563,  5555864.42915558,
        7445836.43467391,  7580045.67304973,  3180529.48560521,
        4539653.33638789,  2737566.56059325,  4734296.74413211,
        3097279.4778012 ,  2888236.78328822,  2935693.71431868,
        3484536.15000843,  5924925.0055523 ,  6131325.04078603,
        6780665.86230314,  9186664.35500273,  2573866.90441659,
        5760693.9021608 ,  4311838.51656294,  3966842.90166098,
        4172402.78106131,  4879542.34363533,  4553509.54723553,
        6308187.76739146,  5049131.43901883,  3046440.53961885,
        3675236.65305413,  3827511.00552656,  5199580.67160478,
        3917901.16069542,  2718741.52889019, 10484042.29621274,
        2608895.22483337,  5164564.38449631,  3790493.39743226,
        4442414.14093879,  2684021.62456047,  3928829.64305369,
        4016823.22581952,  3135386.6416913 ,  4251923.56002748,
        6164478.36779788,  4423598.56593331,  4216831.32469667,
        3097383.9660945 ,  4107520.22621819,  4388800.31034798,
        2685933.96478929,  2319081.54318627,  4768560.29302672,
        5499283.16902807,  4598831.2591019 ,  3301640.07141125,
        5228144.87858335,  3935065.90985356,  2587463.5435268 ,
        3688289.79280069,  4579942.3422359 ,  4936657.88319766,
        3236814.27376369,  3768331.90609022,  3762275.53196056,
        2880499.31553651,  6887850.30377981,  3130079.17188015,
        3736016.36117413,  4134692.23719964,  3596476.70604221,
        3463910.56335901,  4708336.88814398,  8512923.25697332,
        3854996.41329672,  3622991.90589198,  3822248.2617421 ,
        2245502.11598452,  1182655.40937127,  3503674.61469365,
        3693026.89979906,  4623514.98629236,  2674549.81092458,
        5295916.34106386,  2667090.55695825,  3956572.33068349,
        3796551.19264002,  4798012.58734658,  2901400.07771068,
        8888676.68720567,  4412733.25437914,  6216255.41204278,
        5209902.34219279,  6508990.71994256,  4202737.47340994,
        5761731.86305144,  7134863.0086742 ,  5040304.38771428,
        2347464.01378383,  3276470.90506128,  5325093.45922289,
        3082098.34614066])</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_targets</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>10     3745135.0
130    3376145.0
51     3273041.0
11     5161370.0
114    4155435.0
         ...    
71     4136425.0
106    4888774.0
14     1999097.0
92     6782425.0
102    2738052.0
Name: revenue, Length: 109, dtype: float64</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_rsme</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">train_targets</span><span class="p">,</span> <span class="n">train_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">train_rsme</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>1633929.43082441</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_preds</span> <span class="o">=</span> <span class="n">linreg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_inputs</span><span class="p">)</span>
<span class="n">val_preds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([ 2480433.54959437, -2676811.91795901,  1974982.26012497,
        5085938.5079989 ,  4797791.87052252,  4034271.49430067,
        7476796.34155553,  1834625.37894286,  4885354.52997996,
        4631910.08181292,  1218920.95950735,  -320206.42967602,
        3706689.00710156,  7069159.62173087,  1502641.59023729,
        3083970.39776846,  4548768.19625393,  4147395.18425648,
        3552766.81242387,  4073549.56986446, -6033368.50021547,
        2465801.73247237,  4824766.73791544,  3218442.00930671,
        3994736.92727048,  5066134.53345302,  4388800.31034798,
        3697780.80113345])</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rsme</span><span class="p">(</span><span class="n">val_targets</span><span class="p">,</span> <span class="n">val_preds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>4465492.678347902</pre>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ol start="5">
<li>Make Predictions and Submit to Kaggle</li>
</ol>
<ul>
<li>Make predictions for test set</li>
<li>Generate submissions CSV</li>
<li>Submit to Kaggle</li>
<li>Record in experiment tracking sheet</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_inputs</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>P6</th>
<th>P7</th>
<th>P8</th>
<th>P9</th>
<th>P10</th>
<th>...</th>
<th>P28</th>
<th>P29</th>
<th>P30</th>
<th>P31</th>
<th>P32</th>
<th>P33</th>
<th>P34</th>
<th>P35</th>
<th>P36</th>
<th>P37</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>5</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>3</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>5.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>5</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>...</td>
<td>2.0</td>
<td>3.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99996</th>
<td>1</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>1.0</td>
<td>3.0</td>
<td>5</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99997</th>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>...</td>
<td>4.0</td>
<td>1.0</td>
<td>5</td>
<td>5</td>
<td>3</td>
<td>2</td>
<td>4</td>
<td>4</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<th>99998</th>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>4</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>7.5</td>
<td>5.0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99999</th>
<td>2</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>5.0</td>
<td>3.0</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>4</td>
<td>2</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 37 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_preds</span> <span class="o">=</span> <span class="n">linreg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_inputs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sub_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span><span class="o">+</span><span class="s1">&#39;/sampleSubmission.csv&#39;</span><span class="p">)</span>
<span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;Prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_preds</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sub_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>5.726463e+06</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>2.979204e+06</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>1.699815e+06</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>6.310250e+06</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>7.375880e+06</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>99995</td>
<td>3.650596e+06</td>
</tr>
<tr>
<th>99996</th>
<td>99996</td>
<td>3.751165e+06</td>
</tr>
<tr>
<th>99997</th>
<td>99997</td>
<td>6.520077e+06</td>
</tr>
<tr>
<th>99998</th>
<td>99998</td>
<td>3.788442e+06</td>
</tr>
<tr>
<th>99999</th>
<td>99999</td>
<td>1.164775e+07</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 2 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">sub_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;linear_model_submission.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Reusable Function to create submission file</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">predict_and_submit</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_inputs</span><span class="p">,</span> <span class="n">fname</span><span class="p">):</span>
    <span class="n">test_preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_inputs</span><span class="p">)</span>
    <span class="n">sub_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_dir</span><span class="o">+</span><span class="s1">&#39;/sampleSubmission.csv&#39;</span><span class="p">)</span>
    <span class="n">sub_df</span><span class="p">[</span><span class="s1">&#39;Prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">test_preds</span>
    <span class="n">sub_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sub_df</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predict_and_submit</span><span class="p">(</span><span class="n">linreg_model</span><span class="p">,</span> <span class="n">test_inputs</span><span class="p">,</span> <span class="s1">&#39;linear_sub2.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<ol start="6">
<li>Feature Engineering</li>
</ol>
<ul>
<li>Extract parts of date
-(Year, Month, Date, Day of Week, Quarter, Day of Year)</li>
</ul>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add_dateparts</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_weekday&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">weekday</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_quarter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">quarter</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_month_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_month_start</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_month_end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_month_end</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_quarter_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_quarter_start</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_quarter_end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_quarter_end</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_year_start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_year_start</span>
    <span class="n">df</span><span class="p">[</span><span class="n">col</span> <span class="o">+</span> <span class="s1">&#39;_year_end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">is_year_end</span>
    
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">add_dateparts</span><span class="p">(</span><span class="n">train_df</span><span class="p">,</span> <span class="s1">&#39;Open Date&#39;</span><span class="p">)</span>
<span class="n">add_dateparts</span><span class="p">(</span><span class="n">val_df</span><span class="p">,</span> <span class="s1">&#39;Open Date&#39;</span><span class="p">)</span>
<span class="n">add_dateparts</span><span class="p">(</span><span class="n">test_df</span><span class="p">,</span> <span class="s1">&#39;Open Date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Open Date</th>
<th>City</th>
<th>City Group</th>
<th>Type</th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>...</th>
<th>Open Date_month</th>
<th>Open Date_day</th>
<th>Open Date_weekday</th>
<th>Open Date_quarter</th>
<th>Open Date_month_start</th>
<th>Open Date_month_end</th>
<th>Open Date_quarter_start</th>
<th>Open Date_quarter_end</th>
<th>Open Date_year_start</th>
<th>Open Date_year_end</th>
</tr>
</thead>
<tbody>
<tr>
<th>10</th>
<td>10</td>
<td>2013-08-09</td>
<td>Kocaeli</td>
<td>1</td>
<td>2</td>
<td>9</td>
<td>6.0</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>8</td>
<td>9</td>
<td>4</td>
<td>3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>130</th>
<td>130</td>
<td>2011-10-29</td>
<td>Osmaniye</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>10</td>
<td>29</td>
<td>5</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>51</th>
<td>51</td>
<td>2011-11-08</td>
<td>Kastamonu</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>11</td>
<td>8</td>
<td>1</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>11</th>
<td>11</td>
<td>2012-05-22</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>22</td>
<td>1</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>114</th>
<td>114</td>
<td>2008-12-06</td>
<td>Eskişehir</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>12</td>
<td>6</td>
<td>5</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>71</th>
<td>71</td>
<td>2006-12-06</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>2</td>
<td>...</td>
<td>12</td>
<td>6</td>
<td>2</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>106</th>
<td>106</td>
<td>2008-06-15</td>
<td>Antalya</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>3.0</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>6</td>
<td>15</td>
<td>6</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>14</th>
<td>14</td>
<td>2011-12-29</td>
<td>Bursa</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>...</td>
<td>12</td>
<td>29</td>
<td>3</td>
<td>4</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>92</th>
<td>92</td>
<td>2002-11-01</td>
<td>İstanbul</td>
<td>0</td>
<td>2</td>
<td>12</td>
<td>7.5</td>
<td>7.5</td>
<td>6.0</td>
<td>2</td>
<td>...</td>
<td>11</td>
<td>1</td>
<td>4</td>
<td>4</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr>
<th>102</th>
<td>102</td>
<td>2004-09-11</td>
<td>Diyarbakır</td>
<td>1</td>
<td>2</td>
<td>4</td>
<td>5.0</td>
<td>2.0</td>
<td>5.0</td>
<td>2</td>
<td>...</td>
<td>9</td>
<td>11</td>
<td>5</td>
<td>3</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>
<p>109 rows &#215; 54 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">train_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Open Date</th>
<th>City</th>
<th>City Group</th>
<th>Type</th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>...</th>
<th>Open Date_month</th>
<th>Open Date_day</th>
<th>Open Date_weekday</th>
<th>Open Date_quarter</th>
<th>Open Date_month_start</th>
<th>Open Date_month_end</th>
<th>Open Date_quarter_start</th>
<th>Open Date_quarter_end</th>
<th>Open Date_year_start</th>
<th>Open Date_year_end</th>
</tr>
</thead>
<tbody>
<tr>
<th>10</th>
<td>10</td>
<td>2013-08-09</td>
<td>Kocaeli</td>
<td>1</td>
<td>2</td>
<td>9</td>
<td>6.0</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>8</td>
<td>9</td>
<td>4</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>130</th>
<td>130</td>
<td>2011-10-29</td>
<td>Osmaniye</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>10</td>
<td>29</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>51</th>
<td>51</td>
<td>2011-11-08</td>
<td>Kastamonu</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>11</td>
<td>8</td>
<td>1</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>11</th>
<td>11</td>
<td>2012-05-22</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>22</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>114</th>
<td>114</td>
<td>2008-12-06</td>
<td>Eskişehir</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>5.0</td>
<td>5.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>12</td>
<td>6</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>71</th>
<td>71</td>
<td>2006-12-06</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>2</td>
<td>...</td>
<td>12</td>
<td>6</td>
<td>2</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>106</th>
<td>106</td>
<td>2008-06-15</td>
<td>Antalya</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>3.0</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>6</td>
<td>15</td>
<td>6</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>14</th>
<td>14</td>
<td>2011-12-29</td>
<td>Bursa</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>...</td>
<td>12</td>
<td>29</td>
<td>3</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>92</th>
<td>92</td>
<td>2002-11-01</td>
<td>İstanbul</td>
<td>0</td>
<td>2</td>
<td>12</td>
<td>7.5</td>
<td>7.5</td>
<td>6.0</td>
<td>2</td>
<td>...</td>
<td>11</td>
<td>1</td>
<td>4</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>102</th>
<td>102</td>
<td>2004-09-11</td>
<td>Diyarbakır</td>
<td>1</td>
<td>2</td>
<td>4</td>
<td>5.0</td>
<td>2.0</td>
<td>5.0</td>
<td>2</td>
<td>...</td>
<td>9</td>
<td>11</td>
<td>5</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>109 rows &#215; 54 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Open Date</th>
<th>City</th>
<th>City Group</th>
<th>Type</th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>...</th>
<th>Open Date_month</th>
<th>Open Date_day</th>
<th>Open Date_weekday</th>
<th>Open Date_quarter</th>
<th>Open Date_month_start</th>
<th>Open Date_month_end</th>
<th>Open Date_quarter_start</th>
<th>Open Date_quarter_end</th>
<th>Open Date_year_start</th>
<th>Open Date_year_end</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>2011-01-22</td>
<td>Niğde</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>22</td>
<td>5</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>2011-03-18</td>
<td>Konya</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>18</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>2013-10-30</td>
<td>Ankara</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>10</td>
<td>30</td>
<td>2</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>2013-05-06</td>
<td>Kocaeli</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>6</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>2013-07-31</td>
<td>Afyonkarahisar</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>...</td>
<td>7</td>
<td>31</td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>99995</td>
<td>2000-01-05</td>
<td>Antalya</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>5</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99996</th>
<td>99996</td>
<td>2011-07-18</td>
<td>Niğde</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>7</td>
<td>18</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99997</th>
<td>99997</td>
<td>2012-12-29</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>...</td>
<td>12</td>
<td>29</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99998</th>
<td>99998</td>
<td>2013-10-12</td>
<td>İstanbul</td>
<td>0</td>
<td>2</td>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>10</td>
<td>12</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99999</th>
<td>99999</td>
<td>2010-10-05</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>10</td>
<td>5</td>
<td>1</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 53 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_df</span> <span class="o">=</span> <span class="n">val_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">val_df</span> <span class="o">=</span> <span class="n">val_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">True</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">test_df</span><span class="o">.</span><span class="n">applymap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="kc">False</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> <span class="n">val_df</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Open Date</th>
<th>City</th>
<th>City Group</th>
<th>Type</th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>...</th>
<th>Open Date_month</th>
<th>Open Date_day</th>
<th>Open Date_weekday</th>
<th>Open Date_quarter</th>
<th>Open Date_month_start</th>
<th>Open Date_month_end</th>
<th>Open Date_quarter_start</th>
<th>Open Date_quarter_end</th>
<th>Open Date_year_start</th>
<th>Open Date_year_end</th>
</tr>
</thead>
<tbody>
<tr>
<th>105</th>
<td>105</td>
<td>2008-03-15</td>
<td>Aydın</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>2.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>3</td>
<td>15</td>
<td>5</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>104</th>
<td>104</td>
<td>2007-01-22</td>
<td>Adana</td>
<td>1</td>
<td>1</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>22</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>12</th>
<td>12</td>
<td>2013-02-28</td>
<td>Ankara</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>28</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>26</th>
<td>26</td>
<td>2010-02-23</td>
<td>Ankara</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>23</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>123</th>
<td>123</td>
<td>2011-11-05</td>
<td>Bolu</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>1.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>11</td>
<td>5</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>66</th>
<td>66</td>
<td>2010-01-09</td>
<td>Konya</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>1</td>
<td>9</td>
<td>5</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>64</th>
<td>64</td>
<td>1998-07-13</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>2</td>
<td>...</td>
<td>7</td>
<td>13</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>115</th>
<td>115</td>
<td>2012-05-04</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>6</td>
<td>4.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>5</td>
<td>4</td>
<td>4</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>133</th>
<td>133</td>
<td>2006-10-12</td>
<td>İzmir</td>
<td>0</td>
<td>2</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>10</td>
<td>12</td>
<td>3</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>85</th>
<td>85</td>
<td>2000-01-07</td>
<td>İstanbul</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>7</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>84</th>
<td>84</td>
<td>2009-10-09</td>
<td>İzmir</td>
<td>0</td>
<td>1</td>
<td>4</td>
<td>4.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>10</td>
<td>9</td>
<td>4</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>45</th>
<td>45</td>
<td>2012-02-02</td>
<td>Antalya</td>
<td>1</td>
<td>2</td>
<td>6</td>
<td>6.0</td>
<td>6.0</td>
<td>4.5</td>
<td>2</td>
<td>...</td>
<td>2</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>69</th>
<td>69</td>
<td>2011-08-30</td>
<td>Konya</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>2.0</td>
<td>4.0</td>
<td>5.0</td>
<td>4</td>
<td>...</td>
<td>8</td>
<td>30</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>67</th>
<td>67</td>
<td>2011-03-01</td>
<td>İstanbul</td>
<td>0</td>
<td>2</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>5.0</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>31</th>
<td>31</td>
<td>2012-12-31</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>...</td>
<td>12</td>
<td>31</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>42</th>
<td>42</td>
<td>2011-09-27</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>9</td>
<td>27</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>27</th>
<td>27</td>
<td>1999-10-09</td>
<td>Bursa</td>
<td>1</td>
<td>2</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>10</td>
<td>9</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>19</th>
<td>19</td>
<td>2011-08-16</td>
<td>Sakarya</td>
<td>1</td>
<td>1</td>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>8</td>
<td>16</td>
<td>1</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>132</th>
<td>132</td>
<td>2008-06-25</td>
<td>Trabzon</td>
<td>1</td>
<td>2</td>
<td>2</td>
<td>3.0</td>
<td>3.0</td>
<td>5.0</td>
<td>4</td>
<td>...</td>
<td>6</td>
<td>25</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>56</th>
<td>56</td>
<td>2013-03-16</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>3</td>
<td>16</td>
<td>5</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>125</th>
<td>125</td>
<td>2010-09-01</td>
<td>Trabzon</td>
<td>1</td>
<td>1</td>
<td>9</td>
<td>6.0</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>...</td>
<td>9</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>2009-05-09</td>
<td>Gaziantep</td>
<td>1</td>
<td>1</td>
<td>3</td>
<td>4.0</td>
<td>3.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>5</td>
<td>9</td>
<td>5</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>109</th>
<td>109</td>
<td>2007-08-25</td>
<td>Ankara</td>
<td>0</td>
<td>2</td>
<td>2</td>
<td>4.0</td>
<td>3.0</td>
<td>5.0</td>
<td>4</td>
<td>...</td>
<td>8</td>
<td>25</td>
<td>5</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>36</th>
<td>36</td>
<td>2008-05-09</td>
<td>Ankara</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>5.0</td>
<td>5.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>5</td>
<td>9</td>
<td>4</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>89</th>
<td>89</td>
<td>2009-05-11</td>
<td>İstanbul</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>1.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>5</td>
<td>11</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>100</th>
<td>100</td>
<td>2007-09-21</td>
<td>İstanbul</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>9</td>
<td>21</td>
<td>4</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>16</th>
<td>16</td>
<td>2000-01-07</td>
<td>İstanbul</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>...</td>
<td>1</td>
<td>7</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>18</th>
<td>18</td>
<td>2012-04-21</td>
<td>İzmir</td>
<td>0</td>
<td>1</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>...</td>
<td>4</td>
<td>21</td>
<td>5</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>28 rows &#215; 54 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">jovian</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Save intermediate dataframes</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;train.parquet&#39;</span><span class="p">)</span>
<span class="n">val_df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;val.parquet&#39;</span><span class="p">)</span>
<span class="n">test_df</span><span class="o">.</span><span class="n">to_parquet</span><span class="p">(</span><span class="s1">&#39;test.parquet&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Train &amp; Evaluate Different Models
We&#39;ll train each of the following &amp; submit predictions to Kaggle:</p>
<ul>
<li>Linear Regression</li>
<li>Random Forests</li>
<li>Gradient Boosting</li>
</ul>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Split Inputs &amp; Targets</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>Index([&#39;Id&#39;, &#39;Open Date&#39;, &#39;City&#39;, &#39;City Group&#39;, &#39;Type&#39;, &#39;P1&#39;, &#39;P2&#39;, &#39;P3&#39;, &#39;P4&#39;,
       &#39;P5&#39;, &#39;P6&#39;, &#39;P7&#39;, &#39;P8&#39;, &#39;P9&#39;, &#39;P10&#39;, &#39;P11&#39;, &#39;P12&#39;, &#39;P13&#39;, &#39;P14&#39;, &#39;P15&#39;,
       &#39;P16&#39;, &#39;P17&#39;, &#39;P18&#39;, &#39;P19&#39;, &#39;P20&#39;, &#39;P21&#39;, &#39;P22&#39;, &#39;P23&#39;, &#39;P24&#39;, &#39;P25&#39;,
       &#39;P26&#39;, &#39;P27&#39;, &#39;P28&#39;, &#39;P29&#39;, &#39;P30&#39;, &#39;P31&#39;, &#39;P32&#39;, &#39;P33&#39;, &#39;P34&#39;, &#39;P35&#39;,
       &#39;P36&#39;, &#39;P37&#39;, &#39;revenue&#39;, &#39;Open Date_year&#39;, &#39;Open Date_month&#39;,
       &#39;Open Date_day&#39;, &#39;Open Date_weekday&#39;, &#39;Open Date_quarter&#39;,
       &#39;Open Date_month_start&#39;, &#39;Open Date_month_end&#39;,
       &#39;Open Date_quarter_start&#39;, &#39;Open Date_quarter_end&#39;,
       &#39;Open Date_year_start&#39;, &#39;Open Date_year_end&#39;],
      dtype=&#39;object&#39;)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">input_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;City Group&#39;</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">,</span> <span class="s1">&#39;P2&#39;</span><span class="p">,</span> <span class="s1">&#39;P3&#39;</span><span class="p">,</span> <span class="s1">&#39;P4&#39;</span><span class="p">,</span>
       <span class="s1">&#39;P5&#39;</span><span class="p">,</span> <span class="s1">&#39;P6&#39;</span><span class="p">,</span> <span class="s1">&#39;P7&#39;</span><span class="p">,</span> <span class="s1">&#39;P8&#39;</span><span class="p">,</span> <span class="s1">&#39;P9&#39;</span><span class="p">,</span> <span class="s1">&#39;P10&#39;</span><span class="p">,</span> <span class="s1">&#39;P11&#39;</span><span class="p">,</span> <span class="s1">&#39;P12&#39;</span><span class="p">,</span> <span class="s1">&#39;P13&#39;</span><span class="p">,</span> <span class="s1">&#39;P14&#39;</span><span class="p">,</span> <span class="s1">&#39;P15&#39;</span><span class="p">,</span>
       <span class="s1">&#39;P16&#39;</span><span class="p">,</span> <span class="s1">&#39;P17&#39;</span><span class="p">,</span> <span class="s1">&#39;P18&#39;</span><span class="p">,</span> <span class="s1">&#39;P19&#39;</span><span class="p">,</span> <span class="s1">&#39;P20&#39;</span><span class="p">,</span> <span class="s1">&#39;P21&#39;</span><span class="p">,</span> <span class="s1">&#39;P22&#39;</span><span class="p">,</span> <span class="s1">&#39;P23&#39;</span><span class="p">,</span> <span class="s1">&#39;P24&#39;</span><span class="p">,</span> <span class="s1">&#39;P25&#39;</span><span class="p">,</span>
       <span class="s1">&#39;P26&#39;</span><span class="p">,</span> <span class="s1">&#39;P27&#39;</span><span class="p">,</span> <span class="s1">&#39;P28&#39;</span><span class="p">,</span> <span class="s1">&#39;P29&#39;</span><span class="p">,</span> <span class="s1">&#39;P30&#39;</span><span class="p">,</span> <span class="s1">&#39;P31&#39;</span><span class="p">,</span> <span class="s1">&#39;P32&#39;</span><span class="p">,</span> <span class="s1">&#39;P33&#39;</span><span class="p">,</span> <span class="s1">&#39;P34&#39;</span><span class="p">,</span> <span class="s1">&#39;P35&#39;</span><span class="p">,</span>
       <span class="s1">&#39;P36&#39;</span><span class="p">,</span> <span class="s1">&#39;P37&#39;</span><span class="p">,</span> <span class="s1">&#39;Open Date_year&#39;</span><span class="p">,</span> <span class="s1">&#39;Open Date_month&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Open Date_day&#39;</span><span class="p">,</span> <span class="s1">&#39;Open Date_weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;Open Date_quarter&#39;</span><span class="p">,</span> <span class="s1">&#39;Open Date_month_start&#39;</span><span class="p">,</span> <span class="s1">&#39;Open Date_month_end&#39;</span><span class="p">,</span>	<span class="s1">&#39;Open Date_quarter_start&#39;</span><span class="p">,</span> <span class="s1">&#39;Open Date_quarter_end&#39;</span><span class="p">,</span>	<span class="s1">&#39;Open Date_year_start&#39;</span><span class="p">,</span> 	<span class="s1">&#39;Open Date_year_end&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">target_col</span> <span class="o">=</span> <span class="s1">&#39;revenue&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_inputs</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">input_cols</span><span class="p">]</span>
<span class="n">train_targets</span> <span class="o">=</span> <span class="n">train_df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_inputs</span> <span class="o">=</span> <span class="n">val_df</span><span class="p">[</span><span class="n">input_cols</span><span class="p">]</span>
<span class="n">val_targets</span> <span class="o">=</span> <span class="n">val_df</span><span class="p">[</span><span class="n">target_col</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_inputs</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="n">input_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Lets define a helper function to evaluate models</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">model</span><span class="p">):</span>
    <span class="n">train_preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">)</span>
    <span class="n">train_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">train_targets</span><span class="p">,</span> <span class="n">train_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">val_preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_inputs</span><span class="p">)</span>
    <span class="n">val_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">val_targets</span><span class="p">,</span> <span class="n">val_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train_rmse</span><span class="p">,</span> <span class="n">val_rmse</span><span class="p">,</span> <span class="n">train_preds</span><span class="p">,</span> <span class="n">val_preds</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Ridge Regression</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model1</span> <span class="o">=</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">model1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: user 6.35 ms, sys: 1.87 ms, total: 8.22 ms
Wall time: 18.1 ms
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>Ridge(alpha=0.9, random_state=42)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">evaluate</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(1531458.3483940484,
 4414711.143415873,
 array([ 5526118.56499082,  4810737.5977934 ,  2232980.5733988 ,
         4824448.37571463,  3965444.853145  ,  3246489.74416816,
         4291522.67415112,  4772027.43057713,  4975915.57639343,
         5906458.2516779 ,  3095913.07753378,  4679399.20406449,
         6586191.5991464 ,  7853840.13743773,  2992085.44688177,
         4878660.1875062 ,  1884781.95626333,  5271611.84489146,
         2891707.77343622,  2980763.24794686,  3511817.29908034,
         2724174.95105749,  5589555.20278883,  5630690.69672611,
         6190559.19898474,  8926038.57178605,  1970398.85536599,
         5653872.71491149,  3310484.68085417,  4581726.85201403,
         3814137.86099985,  4876984.13873622,  5452879.54584756,
         7226041.57660365,  6362881.43954879,  3438710.37961516,
         2833006.63754404,  3597884.20478588,  4914114.35091472,
         3854863.9878898 ,  2812048.54478157,  9812451.52880609,
         3385746.34324983,  4806538.43685737,  3451572.38712496,
         4102760.32381636,  3595192.59841952,  4393925.556624  ,
         4899692.29010817,  3454255.82490319,  3372009.10482082,
         6305749.83379504,  4386349.90538213,  4691673.22296688,
         2745109.51241502,  4617983.02012607,  3605798.2805903 ,
         3052284.40096498,  2604213.19153479,  4010549.17266339,
         6331635.35329789,  4468173.46836442,  3953795.17150113,
         5395805.51026636,  2943406.46364874,  2115932.6909931 ,
         4009256.98795366,  5306161.53945708,  5721930.58449268,
         3365057.98285642,  3625241.57957932,  3446511.34905368,
         3273242.27114683,  6160755.74169111,  2619657.19731706,
         3147128.67291301,  4209446.58360276,  2930704.29978812,
         3528533.58863965,  5016351.36087254,  9102563.49670389,
         4267074.42078963,  4094853.60695174,  3747188.814601  ,
         1500306.34292626,  1609920.40988714,  3727738.3295823 ,
         3836705.28491163,  3718243.14071417,  3014405.81650388,
         5330605.88043064,  2258399.73335391,  3454155.29218191,
         3247046.73751211,  4236673.30254042,  1855439.66664565,
        10012221.45160291,  5002311.72823441,  5476425.27973235,
         4964132.73383862,  6087354.05414504,  4998552.0955402 ,
         5116409.45170295,  6283268.05363342,  5106006.92286497,
         3355861.93833485,  4040596.04568613,  5898179.5376775 ,
         3838179.29021198]),
 array([ 2852942.86162856, -3260701.58916765,  2763058.0816139 ,
         5504008.66139242,  4633486.4504405 ,  3607152.29804611,
         8790566.4826825 ,   624118.83965755,  5406415.23895028,
         5015138.04648805,  2215662.38332829, -3117402.33823171,
         4676720.12651095,  5246262.15827745,  2036773.49378768,
         3967910.99047861,  5710895.99915585,  3265742.00897947,
         4260212.52246004,  3526343.19155598, -4096427.8250494 ,
         1740856.33421132,  5905509.18569896,  2923776.66645923,
         3236362.64163089,  5355860.38670871,  4750551.13327855,
         3974356.99557477]))</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predict_and_submit</span><span class="p">(</span><span class="n">model1</span><span class="p">,</span> <span class="n">test_inputs</span><span class="p">,</span> <span class="s1">&#39;ridge_submission.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>4.232496e+06</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>3.302126e+06</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>3.093557e+06</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>4.483835e+06</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>6.558818e+06</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>99995</td>
<td>4.141207e+06</td>
</tr>
<tr>
<th>99996</th>
<td>99996</td>
<td>2.427050e+06</td>
</tr>
<tr>
<th>99997</th>
<td>99997</td>
<td>7.177982e+06</td>
</tr>
<tr>
<th>99998</th>
<td>99998</td>
<td>3.443719e+06</td>
</tr>
<tr>
<th>99999</th>
<td>99999</td>
<td>1.056547e+07</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 2 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Random Forest</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">model2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: user 275 ms, sys: 22.1 ms, total: 297 ms
Wall time: 235 ms
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>RandomForestRegressor(max_depth=10, n_jobs=-1, random_state=42)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">evaluate</span><span class="p">(</span><span class="n">model2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(921698.1655217543,
 3448541.0297794407,
 array([ 3738987.01436236,  3603217.91834306,  3422290.861875  ,
         4514481.49193379,  4162379.77014045,  4239950.84776579,
         3022966.98521396,  3271358.18352381,  5152906.95277778,
         4962655.06784722,  4066819.8042076 ,  4773503.91951515,
         5576447.66896476,  7993460.98266667,  3491527.0978584 ,
         4786761.46302778,  3767126.77134587,  4099628.14768689,
         3615037.31734524,  3679561.8620809 ,  4154759.63983238,
         4597915.32004292,  6011166.26968452,  6458494.24658333,
         6005127.36378265,  7227079.77773016,  3463355.83639502,
         4264063.50316119,  3415338.23590293,  5003457.28367021,
         2704686.93377378,  5794784.559417  ,  4187667.77798336,
         6187890.52929917,  4682116.28323016,  2032957.32398718,
         4225345.13207846,  5098858.50480952,  4835635.6558631 ,
         2274509.54294444,  3911244.62847132,  7308428.49397744,
         4068699.07303205,  4406011.22000397,  4013138.65718301,
         4906000.12640368,  3303663.80426133,  4501937.36222149,
         3833451.24138915,  2734673.44296715,  3842124.07972833,
         4668368.36064423,  4702706.10386736,  3941702.00946265,
         3051220.30025   ,  6074052.37041667,  5014341.70120725,
         3209121.16133014,  3297365.90501316,  4824210.97524866,
         6434290.0052301 ,  4169848.73427808,  4251950.60119439,
         4410525.25563324,  3040102.23264345,  1916905.67119203,
         4173024.76497977,  5602068.86793956,  5216183.12216029,
         3075722.05685604,  5551074.70298016,  2984868.79520912,
         2950351.93482843,  6507682.85297619,  3289599.77413681,
         3758494.34593379,  5839102.84848335,  1978047.68559829,
         3876609.43065084,  3774790.95686174, 11561664.96355189,
         3408838.7506929 ,  3640550.2828463 ,  3825300.9810398 ,
         1837367.11333333,  3451354.29894872,  3438520.86366497,
         3682200.96286354,  3881378.63642982,  4301749.26888599,
         6437570.97009518,  1894114.26583333,  2862176.83750397,
         2063055.13611111,  3363218.57901525,  3986343.06925497,
        10507733.73      ,  7383258.868     ,  5461376.10055754,
         3585530.18294718,  5590755.43625   ,  3681581.77791108,
         6045181.97319931,  4903427.37561111,  4355667.63464808,
         4843080.52604905,  3021252.28454624,  5738810.16837897,
         3323938.41028384]),
 array([3142053.52079391, 4722358.04075794, 2591292.38365385,
        4567483.63907828, 3432065.97138599, 3620512.75410618,
        5243936.41773016, 4891477.9565    , 5360104.46545864,
        4447629.01704821, 4234808.03403908, 4092190.35144841,
        4930428.70188309, 5184169.47141558, 5481706.55607085,
        4468365.03949927, 4546036.18993284, 3852047.0528095 ,
        3855847.1692515 , 4419807.04006349, 4428816.40083333,
        3523008.70099818, 4230806.10182477, 4172646.70040127,
        3915668.17228788, 4356028.79492025, 4549267.71633393,
        3995520.48179094]))</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predict_and_submit</span><span class="p">(</span><span class="n">model2</span><span class="p">,</span> <span class="n">test_inputs</span><span class="p">,</span> <span class="s1">&#39;randomforest_submission.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>4.319865e+06</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>3.501526e+06</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>5.352865e+06</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>3.563112e+06</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>5.676442e+06</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>99995</td>
<td>4.396236e+06</td>
</tr>
<tr>
<th>99996</th>
<td>99996</td>
<td>3.304446e+06</td>
</tr>
<tr>
<th>99997</th>
<td>99997</td>
<td>4.406868e+06</td>
</tr>
<tr>
<th>99998</th>
<td>99998</td>
<td>3.734601e+06</td>
</tr>
<tr>
<th>99999</th>
<td>99999</td>
<td>4.863295e+06</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 2 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Gradient Boosting</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">xgboost</span> <span class="kn">import</span> <span class="n">XGBRegressor</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model3</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">objective</span><span class="o">=</span><span class="s1">&#39;reg:squarederror&#39;</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">model3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: user 184 ms, sys: 25.3 ms, total: 209 ms
Wall time: 218 ms
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>XGBRegressor(max_depth=5, n_estimators=200, n_jobs=-1,
             objective=&#39;reg:squarederror&#39;, random_state=42)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">evaluate</span><span class="p">(</span><span class="n">model3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(5139.032353534721,
 3343077.633891366,
 array([ 3741274.8,  3377184.2,  3276539.2,  5158655. ,  4153159.5,
         4577022.5,  2344003.2,  2019087.4,  4759804. ,  5650341. ,
         3869263.5,  5286270.5,  6833167. ,  8906744. ,  3164524.2,
         4287102.5,  3405882.5,  4262796. ,  3219170.8,  3364748.5,
         3817091. ,  3958470. ,  6939363.5,  3348509.2,  6691777.5,
         7866666.5,  3010689.2,  3728773.8,  3566844. ,  5446307. ,
         2375871.8,  7576503.5,  3785837. ,  5969609. ,  4706228. ,
         1754277.1,  3836547.5,  5593281.5,  5018378. ,  1906284.2,
         3808732.5,  8623352. ,  3903147.2,  4109794. ,  3753216.5,
         4486139.5,  2732000.8,  3986147.5,  4063712. ,  2110387.2,
         3779644. ,  4952659.5,  4812527. ,  3809589.2,  2674159.5,
         8210296. ,  5458938. ,  2528121.2,  2954382.5,  5164297.5,
         7208422.5,  3944153.8,  3785666.2,  4650724. ,  2160889.8,
         1280976. ,  4248346. ,  6414885. ,  4350943.5,  2542403. ,
         6312780. ,  2981873.8,  2088484. ,  4554998.5,  3003863. ,
         3436637. ,  7182179. ,  2024353.6,  4060037.8,  3255549.5,
        16542738. ,  3260406.2,  3200348.5,  3598467.5,  1620265.6,
         1850000.9,  2741931.5,  3449562.2,  3248191.2,  4019494.5,
         6919700. ,  1763595.2,  1151247.8,  2054379.6,  3006379.5,
         4425801.5, 13577236. ,  8891868. ,  5908927.5,  2404728. ,
         5500753. ,  3446514.5,  6365121. ,  5526264.5,  4136625.2,
         4888822. ,  2002317.8,  6779621.5,  2739979.5], dtype=float32),
 array([2403598.5, 4499937. , 1880779. , 4657643. , 3686156. , 3800835.2,
        5053510. , 3784855.8, 5943915.5, 4700496. , 3683681. , 5243117. ,
        3775895. , 4085532.2, 4354419.5, 5256806. , 4789258. , 3928874.8,
        3836199. , 2344591.2, 3838000.5, 3247787.8, 3384883.5, 4989175. ,
        3799063. , 4943690.5, 4701290. , 3058652.2], dtype=float32))</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predict_and_submit</span><span class="p">(</span><span class="n">model3</span><span class="p">,</span> <span class="n">test_inputs</span><span class="p">,</span> <span class="s1">&#39;gradientboosting_submission.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>3451738.25</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>2408422.00</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>5423849.50</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>3453046.75</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>6585988.50</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>99995</td>
<td>4475658.00</td>
</tr>
<tr>
<th>99996</th>
<td>99996</td>
<td>2899429.25</td>
</tr>
<tr>
<th>99997</th>
<td>99997</td>
<td>4126614.75</td>
</tr>
<tr>
<th>99998</th>
<td>99998</td>
<td>3741861.00</td>
</tr>
<tr>
<th>99999</th>
<td>99999</td>
<td>6875492.00</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 2 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Tune Hyperparmeters</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">test_params</span><span class="p">(</span><span class="n">ModelClass</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Trains a model with the given parameters and returns training &amp; validation RMSE&quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">ModelClass</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)</span>
    <span class="n">train_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">),</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">val_rmse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_inputs</span><span class="p">),</span> <span class="n">val_targets</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">train_rmse</span><span class="p">,</span> <span class="n">val_rmse</span>

<span class="k">def</span> <span class="nf">test_param_and_plot</span><span class="p">(</span><span class="n">ModelClass</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param_values</span><span class="p">,</span> <span class="o">**</span><span class="n">other_params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Trains multiple models by varying the value of param_name according to param_values&quot;&quot;&quot;</span>
    <span class="n">train_errors</span><span class="p">,</span> <span class="n">val_errors</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> 
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">param_values</span><span class="p">:</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">other_params</span><span class="p">)</span>
        <span class="n">params</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">train_rmse</span><span class="p">,</span> <span class="n">val_rmse</span> <span class="o">=</span> <span class="n">test_params</span><span class="p">(</span><span class="n">ModelClass</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">train_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">train_rmse</span><span class="p">)</span>
        <span class="n">val_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val_rmse</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Overfitting curve: &#39;</span> <span class="o">+</span> <span class="n">param_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">train_errors</span><span class="p">,</span> <span class="s1">&#39;b-o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_values</span><span class="p">,</span> <span class="n">val_errors</span><span class="p">,</span> <span class="s1">&#39;r-o&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">param_name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;RMSE&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Training&#39;</span><span class="p">,</span> <span class="s1">&#39;Validation&#39;</span><span class="p">])</span>
<span class="n">best_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
    <span class="s1">&#39;n_jobs&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;objective&#39;</span><span class="p">:</span> <span class="s1">&#39;reg:squarederror&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>No. of Trees</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span> 
<span class="n">test_param_and_plot</span><span class="p">(</span><span class="n">XGBRegressor</span><span class="p">,</span> <span class="s1">&#39;n_estimators&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="o">**</span><span class="n">best_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: user 580 ms, sys: 5.47 ms, total: 586 ms
Wall time: 367 ms
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output">
<img alt="No description has been provided for this image" class="jp-needs-light-background" src="javascript://"/>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">best_params</span><span class="p">[</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">250</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span> 
<span class="n">test_param_and_plot</span><span class="p">(</span><span class="n">XGBRegressor</span><span class="p">,</span> <span class="s1">&#39;max_depth&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="o">**</span><span class="n">best_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: user 582 ms, sys: 6.48 ms, total: 589 ms
Wall time: 301 ms
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output">
<img alt="No description has been provided for this image" class="jp-needs-light-background" src="javascript://"/>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">best_params</span><span class="p">[</span><span class="s1">&#39;max_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">test_param_and_plot</span><span class="p">(</span><span class="n">XGBRegressor</span><span class="p">,</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">],</span> <span class="o">**</span><span class="n">best_params</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: user 732 ms, sys: 10.4 ms, total: 743 ms
Wall time: 396 ms
</pre>
</div>
</div>
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedImage jp-OutputArea-output">
<img alt="No description has been provided for this image" class="jp-needs-light-background" src="javascript://"/>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">best_params</span><span class="p">[</span><span class="s1">&#39;learning_rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">xgb_model_final</span> <span class="o">=</span> <span class="n">XGBRegressor</span><span class="p">(</span><span class="n">objective</span><span class="o">=</span><span class="s1">&#39;reg:squarederror&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
                               <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> 
                               <span class="n">subsample</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">colsample_bytree</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>
<span class="n">xgb_model_final</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child">
<div class="jp-OutputPrompt jp-OutputArea-prompt"></div>
<div class="jp-RenderedText jp-OutputArea-output">
<pre>CPU times: user 391 ms, sys: 4.87 ms, total: 396 ms
Wall time: 213 ms
</pre>
</div>
</div>
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>XGBRegressor(colsample_bytree=0.8, max_depth=5, n_estimators=500, n_jobs=-1,
             objective=&#39;reg:squarederror&#39;, random_state=42, subsample=0.8)</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">evaluate</span><span class="p">(</span><span class="n">xgb_model_final</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>(2.5563320824173705,
 3253849.638139607,
 array([ 3745134.2,  3376146.2,  3273041.2,  5161368. ,  4155434.2,
         4590419.5,  2344689. ,  2018785.8,  4758477.5,  5653753.5,
         3871343.5,  5286210. ,  6836484. ,  8904088. ,  3164970.8,
         4286645.5,  3410877.2,  4264175. ,  3218917.2,  3351385.2,
         3818055.5,  3956087.2,  6941171.5,  3347771.5,  6694795. ,
         7865427.5,  3008199. ,  3727369.8,  3570392.5,  5444228.5,
         2371204.8,  7592273.5,  3778620.2,  5966194. ,  4705942. ,
         1756067.1,  3836721.8,  5595268. ,  5017319.5,  1904842.2,
         3807496.8,  8630680. ,  3903884.8,  4100890. ,  3753719.2,
         4491605. ,  2732645. ,  3982769. ,  4066618.8,  2097024.8,
         3780018.8,  4952496. ,  4807737. ,  3810008.2,  2675511.2,
         8213523. ,  5461701. ,  2525374.5,  2954085.8,  5166638. ,
         7217631.5,  3939801.8,  3784230.8,  4651866.5,  2156097. ,
         1270507. ,  4250757.5,  6412625. ,  4350575.5,  2544856. ,
         6313221.5,  2993062.8,  2083446.9,  4554236.5,  3004426.2,
         3426170.5,  7201781. ,  2025296.1,  4067563.5,  3258836.8,
        16549060. ,  3261921.8,  3199620.8,  3600468.8,  1619682.9,
         1847825.9,  2740688. ,  3447889.2,  3248660. ,  4015750.5,
         6923132.5,  1763233.9,  1149871. ,  2055377.2,  2999067. ,
         4429504. , 13575226. ,  8894590. ,  5906598. ,  2383847.2,
         5500819. ,  3445078.2,  6363243.5,  5525735.5,  4136425.2,
         4888772. ,  1999102.4,  6782423.5,  2738052.5], dtype=float32),
 array([2206682. , 3996438.8, 2093343.1, 4226628. , 3427501.5, 3669919. ,
        5088788. , 3148559.8, 6378052. , 5088868.5, 4143476. , 3867471.2,
        3966150. , 4953127.5, 4805480.5, 4294192.5, 5411077.5, 3839419.8,
        3978847.2, 4236370. , 3952950.8, 3420565.5, 4529569. , 4852538.5,
        4070325.2, 5103358. , 5140964.5, 3098509.8], dtype=float32))</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predict_and_submit</span><span class="p">(</span><span class="n">xgb_model_final</span><span class="p">,</span> <span class="n">test_inputs</span><span class="p">,</span> <span class="s1">&#39;Gradientboosting_tuned_submission.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>4221671.00</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>3244037.25</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>5069854.50</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>3838041.00</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>6436528.50</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>99995</td>
<td>4379875.00</td>
</tr>
<tr>
<th>99996</th>
<td>99996</td>
<td>2461356.25</td>
</tr>
<tr>
<th>99997</th>
<td>99997</td>
<td>3365806.00</td>
</tr>
<tr>
<th>99998</th>
<td>99998</td>
<td>3192164.25</td>
</tr>
<tr>
<th>99999</th>
<td>99999</td>
<td>5930030.00</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 2 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Linear Regression Again</p>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">linreg_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">linreg_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>LinearRegression()</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_preds</span> <span class="o">=</span> <span class="n">linreg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">)</span>
<span class="n">train_preds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([ 5484206.69821504,  4719200.54316565,  2205105.97527134,
        5147026.47753844,  4259298.95939845,  3198056.13579884,
        4512692.10702536,  4559040.79067531,  4669320.12831727,
        6011644.50359368,  3097790.32255599,  4695066.428377  ,
        6831468.39309326,  7918699.59102941,  3049832.53402904,
        4847162.75164324,  1784850.61090642,  5245702.57609862,
        2922967.95372078,  2887927.33590722,  3458525.1712513 ,
        2575384.24470186,  5650306.82122365,  5752826.15189686,
        6165943.94621238,  9194727.12132213,  2053312.5741837 ,
        5769282.92226064,  3470096.87841949,  4602950.12368706,
        3703393.60514414,  5012971.22654393,  5367049.9286823 ,
        7373618.14888251,  6244883.33920079,  3462594.8862648 ,
        2733570.19994912,  3555446.84417066,  4939710.03065109,
        3760242.8345347 ,  2664302.41212013, 10011383.75529808,
        3157269.69833913,  4897305.92765775,  3863964.92687061,
        4142628.50479776,  3423405.34835866,  4345839.99080846,
        4963894.65328336,  3441816.12257376,  3475065.83901095,
        6440446.81275028,  4393270.46029204,  4673033.36430237,
        2757749.80655551,  4619369.93168536,  3474200.31882915,
        2845815.89963582,  2777205.34535855,  3931587.09808683,
        6258972.84647816,  4468591.05888534,  3733758.94763789,
        5655133.99788916,  2836437.22409075,  1950133.78519136,
        3767200.939899  ,  5421510.59940666,  5909198.00133342,
        3315250.02932402,  3486818.38385388,  3443601.17135182,
        3164774.52765518,  6013806.34028003,  2461268.86857468,
        3146301.14235437,  4159837.84991595,  2798510.34338599,
        3457223.71117654,  5173122.3324576 ,  9396245.93237117,
        4195073.87016436,  4018989.58480063,  3761502.65517938,
        1353482.73682433,  1484104.28741917,  3958535.39109778,
        3695851.01739058,  3652336.50949028,  2928228.28362989,
        5407872.81474823,  2133571.28077376,  3416407.71198156,
        3301608.34286538,  4240558.70379385,  1696052.03505069,
       10204044.96407387,  5050650.76513621,  5587774.26962495,
        5000808.01153025,  6034462.02061862,  4976196.12558651,
        5085804.94763255,  6532090.65272748,  4883520.30019024,
        3425545.59048003,  4075922.59218439,  5891622.19449541,
        3779602.27483612])</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">train_rsme</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">train_targets</span><span class="p">,</span> <span class="n">train_preds</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">train_rsme</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>1525302.3169612505</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">val_preds</span> <span class="o">=</span> <span class="n">linreg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">val_inputs</span><span class="p">)</span>
<span class="n">val_preds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>array([ 2841685.51912624, -4971732.30286568,  2838709.16660124,
        5626427.04602239,  4917925.14756057,  3666861.01652437,
        7763402.52431262,   169246.52447453,  5350349.82215017,
        4968867.9041816 ,  2152070.98468906, -3501798.50137073,
        4768543.55057296,  5340677.10925552,  1462997.46183565,
        4123416.02917987,  5764070.25532469,  3168874.92057088,
        4129209.91055787,  3566790.42398012, -4688971.52838886,
        1419967.59869286,  5944202.57420099,  2939368.06613675,
        3165886.65505511,  5443535.27237162,  4697420.37912792,
        4710267.98336405])</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">rsme</span><span class="p">(</span><span class="n">val_targets</span><span class="p">,</span> <span class="n">val_preds</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult">
<pre>4582976.079523277</pre>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_inputs</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>City Group</th>
<th>Type</th>
<th>P1</th>
<th>P2</th>
<th>P3</th>
<th>P4</th>
<th>P5</th>
<th>P6</th>
<th>P7</th>
<th>P8</th>
<th>...</th>
<th>Open Date_month</th>
<th>Open Date_day</th>
<th>Open Date_weekday</th>
<th>Open Date_quarter</th>
<th>Open Date_month_start</th>
<th>Open Date_month_end</th>
<th>Open Date_quarter_start</th>
<th>Open Date_quarter_end</th>
<th>Open Date_year_start</th>
<th>Open Date_year_end</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>2</td>
<td>1</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>1</td>
<td>22</td>
<td>5</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>1</td>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>...</td>
<td>3</td>
<td>18</td>
<td>4</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>0</td>
<td>2</td>
<td>3</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>10</td>
<td>30</td>
<td>2</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>1</td>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>3</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>5</td>
<td>6</td>
<td>0</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>2</td>
<td>2</td>
<td>4.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>4</td>
<td>...</td>
<td>7</td>
<td>31</td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>1</td>
<td>2</td>
<td>5</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>1</td>
<td>5</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99996</th>
<td>1</td>
<td>1</td>
<td>1</td>
<td>2.0</td>
<td>4.0</td>
<td>3.0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>5</td>
<td>...</td>
<td>7</td>
<td>18</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99997</th>
<td>0</td>
<td>1</td>
<td>4</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>1</td>
<td>2</td>
<td>5</td>
<td>3</td>
<td>...</td>
<td>12</td>
<td>29</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99998</th>
<td>0</td>
<td>2</td>
<td>12</td>
<td>7.5</td>
<td>6.0</td>
<td>6.0</td>
<td>4</td>
<td>4</td>
<td>10</td>
<td>10</td>
<td>...</td>
<td>10</td>
<td>12</td>
<td>5</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>99999</th>
<td>0</td>
<td>1</td>
<td>2</td>
<td>5.0</td>
<td>4.0</td>
<td>4.0</td>
<td>2</td>
<td>2</td>
<td>5</td>
<td>5</td>
<td>...</td>
<td>10</td>
<td>5</td>
<td>1</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 50 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell jp-mod-noOutputs">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">test_preds</span> <span class="o">=</span> <span class="n">linreg_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_inputs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div class="jp-Cell jp-CodeCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea">
<div class="jp-InputPrompt jp-InputArea-prompt">In&#160;[&#160;]:</div>
<div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor">
<div class="cm-editor cm-s-jupyter">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predict_and_submit</span><span class="p">(</span><span class="n">linreg_model</span><span class="p">,</span> <span class="n">test_inputs</span><span class="p">,</span> <span class="s1">&#39;linear_submission2.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="jp-Cell-outputWrapper">
<div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser">
</div>
<div class="jp-OutputArea jp-Cell-outputArea">
<div class="jp-OutputArea-child jp-OutputArea-executeResult">
<div class="jp-OutputPrompt jp-OutputArea-prompt">Out[&#160;]:</div>
<div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult">
<div>
<div class="colab-df-container">
<div>

<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Id</th>
<th>Prediction</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>3.981187e+06</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>3.124804e+06</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>2.961698e+06</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>4.280778e+06</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>6.542808e+06</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>99995</th>
<td>99995</td>
<td>3.897671e+06</td>
</tr>
<tr>
<th>99996</th>
<td>99996</td>
<td>2.543383e+06</td>
</tr>
<tr>
<th>99997</th>
<td>99997</td>
<td>7.438942e+06</td>
</tr>
<tr>
<th>99998</th>
<td>99998</td>
<td>3.955840e+06</td>
</tr>
<tr>
<th>99999</th>
<td>99999</td>
<td>1.168659e+07</td>
</tr>
</tbody>
</table>
<p>100000 rows &#215; 2 columns</p>
</div>








</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
<div class="jp-Cell-inputWrapper">
<div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser">
</div>
<div class="jp-InputArea jp-Cell-inputArea"><div class="jp-InputPrompt jp-InputArea-prompt">
</div><div class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput">
<p>Conclusion</p>
<p>Based on the validation RMSE values:</p>
<p>Gradient Boosting is the best-performing model with a validation RMSE of 3,343,077.63.</p>
<p>Random Forest comes next with a validation RMSE of 3,448,541.03.</p>
<p>Ridge Regression performs the worst with a validation RMSE of 4,414,711.14.</p>
<p>Gradient Boosting is the optimal choice among the models evaluated for predicting the target variable with the given dataset, as it shows the best balance between fitting the training data and generalizing to new data.</p>
</div>
</div>
</div>
</div>
</main>


<script type="module" src="https://s.brightspace.com/lib/bsi/2024.7.190/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
						if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
							document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
								elm.setAttribute('style', 'display: block; height: 0.5rem;');
							});

							window.D2L.MathJax.loadMathJax({
								outputScale: 1.5,
								renderLatex: true,
								enableMML3Support: false
							});
						}
					});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2024.7.190/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/2024.7.190/unbundled/embeds.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					window.D2L.EmbedRenderer.renderEmbeds(document.body);
				});</script></body></html>